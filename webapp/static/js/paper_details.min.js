$(document).ready(function(){var b;function e(){$(".attachment").each(function(h,g){var f=$(g).attr("id");$(g).find(".fulltext").each(function(o,m){var l=$("#"+f+" .complete .text").html();var j=OpenRIS.truncateText(l,350);var i=$('<div class="truncated"><div class="text">'+j+"</div></div>");$(m).append(i);$("#"+f+" .complete").hide();if(l.length>j.length){var k=$(document.createElement("a")).attr("href","#").text("Gesamten Text anzeigen");k.click({attachment_id:f,content:l},function(n){n.preventDefault();$("#"+n.data.attachment_id+" .truncated").hide();$("#"+n.data.attachment_id+" .complete").slideDown()});$("#"+f+" .truncated").append(k)}})})}function c(f){f.preventDefault();var g=0;$("#"+f.data.file_id+" img").each(function(j){var i=$(this);var k=800;var h=i.data("width800");g+=h+10;i.animate({width:h,height:k},{duration:400,easing:"swing"});i.attr("src",i.attr("src").replace("/300/","/800/"));i.parent("a").replaceWith(i)});$("#"+f.data.file_id+" .thumbsinner").css({width:g});$("#"+f.data.file_id+" .thumbs").animate({height:"825px"},{duration:300,easing:"swing"});$("#"+f.data.file_id+" .thumbsinner").animate({height:"810px"},{duration:300,easing:"swing"})}function a(f){b={};$.each(f.response.documents[0].attachments,function(g,h){b[h._id]={};$.each(h.thumbnails,function(i,j){if(i==300||i==800){b[h._id][i]={num_thumbs:0,width:0,images:[]};$.each(h.thumbnails[i],function(l,k){b[h._id][i].num_thumbs+=1;b[h._id][i].width+=k.width+11;b[h._id][i].images.push({width:k.width,url:k.url})})}})})}function d(){$("img.thumb").each(function(h,k){var m=$(k).attr("src").split("/");var g=m[(m.length-1)];var l=g.split(".")[0];var f=m[(m.length-2)];var j=m[(m.length-3)];$(this).wrap('<a href="#"></a>');$(this).parent().click({file_id:j,height:f,index:(l-1)},c)})}d();e()});